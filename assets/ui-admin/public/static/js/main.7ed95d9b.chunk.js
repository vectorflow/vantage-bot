(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(126));t.BOTID_REGEX=/^[A-Z0-9]+[A-Z0-9_-]{2,}[A-Z0-9]+$/i,t.isValidBotId=function(e){return t.BOTID_REGEX.test(e)},t.BotCreationSchema=r.default.object().keys({id:r.default.string().regex(t.BOTID_REGEX).required(),name:r.default.string().min(3).max(50).required(),description:r.default.string().min(3).max(50),team:r.default.number().required()}),t.BotEditSchema=r.default.object().keys({name:r.default.string().min(3).max(50).required(),description:r.default.string().min(3).max(50).required()})},186:function(e,t,n){e.exports=n.p+"static/media/botpress.ac0a474b.svg"},189:function(e,t,n){e.exports=n.p+"static/media/loading-circle.eb332664.svg"},1935:function(e,t){},1937:function(e,t){},1969:function(e,t){},1970:function(e,t){},198:function(e,t,n){e.exports=n(2067)},2067:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(35),o=n.n(s),i=n(69),l=(n(211),n(213),n(2071)),c=n(2070),u=n(2069),m=n(22),p=n(47),d=n(6),h=n(7),f=n(10),E=n(8),g=n(9),v=n(3),b=n(20),y=n(5),w=n.n(y),O=n(11),C=n(14),k=n(195),j=n(21),M=n.n(j),S=n(55),P=n.n(S),T=n(182),R=n.n(T),x=n(183),N=n.n(x),I=n(184),_=function(e){e.location=Object.assign(e.location,{query:N.a.parse(e.location.search)})},U=n.n(I)()({basename:"/admin"});_(U),U.listen(function(){return _(U)});var D=U,B=n(185),A=n.n(B),F="bp/token",L="/home";function H(){var e=localStorage.getItem(F);return e&&JSON.parse(e)||{token:null,expires:0}}function K(){localStorage.removeItem(F),D.replace(L),window.location.reload()}var z=function(){function e(){var t=this;Object(d.a)(this,e),this.login=function(){var e=Object(O.a)(w.a.mark(function e(n){var a,r,s;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.username,r=n.password,s=n.newPassword,!t.isAuthenticated()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.doLogin({username:a,password:r,newPassword:s});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.logout=function(){K()}}return Object(h.a)(e,[{key:"doLogin",value:function(){var e=Object(O.a)(w.a.mark(function e(t){var n,a,r,s,o,i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,a=t.password,r=t.newPassword,e.next=3,J.getAnonymous({toastErrors:!1}).post("/auth/login",{username:n,password:a,newPassword:r});case 3:s=e.sent,o=s.data,this.setSession({expiresIn:7200,idToken:o.payload.token}),(i=D.location.query.returnTo)?window.location.replace(i):D.replace(L);case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setSession",value:function(e){var t=e.expiresIn;!function(e,t){var n=JSON.stringify({token:e,expires:t||new Date+A()("4h"),time:new Date});localStorage.setItem(F,n)}(e.idToken,JSON.stringify(1e3*(t||7200)+(new Date).getTime()))}},{key:"parseJwt",value:function(e){var t=e.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(t))}},{key:"isAuthenticated",value:function(){var e=H(),t=e.token,n=e.expires;return t&&(new Date).getTime()<n}}]),e}(),V={timeout:2e3},Y=function(e,t){var n=t.toastErrors,a=R.a.create(Object(C.a)({},V,e));return a.interceptors.response.use(function(e){return e},function(e){var t=M.a.get(e,"response.data"),n=M.a.get(t,"errorCode");return n?"BP_0005"===n?K():P.a.reject(t):P.a.reject(e)}),n&&a.interceptors.response.use(function(e){return e},function(e){var t=M.a.get(e,"response.data.message");return t?Q(t):e.message?Q(e.message):Q("Something wrong happened. Please try again later."),P.a.reject(e)}),a},Q=function(e){i.toast.error(e,{position:i.toast.POSITION.TOP_RIGHT})},G=Object({NODE_ENV:"production",PUBLIC_URL:"/admin"}).REACT_APP_API_URL?{baseURL:"".concat(Object({NODE_ENV:"production",PUBLIC_URL:"/admin"}).REACT_APP_API_URL,"/api/v1")}:{baseURL:"/api/v1"},J={getSecured:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.token,n=e.toastErrors,a=void 0===n||n;if(!t){var r=H();t=r&&r.token}return Y(Object(C.a)({headers:{Authorization:"Bearer ".concat(t)}},G),{toastErrors:a})},getAnonymous:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toastErrors;return Y(G,{toastErrors:void 0===e||e})}},q={loadingTeams:!1,loadingTeam:!1,teamId:null,items:null,bots:null,members:null,roles:null,team:null,permissions:null,license:null,botTemplates:null},W=/^\/teams\/(\d+)/,Z=function(){return function(){var e=Object(O.a)(w.a.mark(function e(t,n){var a,r,s;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),!a.teams.loadingTeams){e.next=3;break}return e.abrupt("return");case 3:return t({type:"teams/FETCH_TEAMS_REQUESTED"}),e.next=6,J.getSecured().get("/admin/teams");case 6:r=e.sent,s=r.data,t({type:"teams/FETCH_TEAMS_RECEIVED",teams:s.payload});case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bots:!0,members:!0,roles:!0};return function(){var n=Object(O.a)(w.a.mark(function n(a,r){var s,o,i;return w.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(s=r(),!s.teams.loadingTeam){n.next=3;break}return n.abrupt("return");case 3:return a({type:"teams/SWITCH_TEAM_REQUESTED",teamId:e}),n.next=6,P.a.props({teams:J.getSecured().get("/admin/teams").then(function(e){return e.data}),bots:t.bots?J.getSecured().get("/admin/teams/".concat(e,"/bots")).then(function(e){return e.data}):null,members:t.members?J.getSecured().get("/admin/teams/".concat(e,"/members")).then(function(e){return e.data}):null,roles:t.roles?J.getSecured().get("/admin/teams/".concat(e,"/roles")).then(function(e){return e.data}):null});case 6:o=n.sent,i=M.a.find(o.teams.payload,function(t){return t.id==e}),a({type:"teams/SWITCH_TEAM_RECEIVED",teamId:e,team:i,bots:t.bots?o.bots.payload.bots:null,members:t.members?o.members.payload:null,roles:t.roles?(l=o.roles.payload,l.sort(function(e,t){return"owner"===e.name?-1:"owner"===t.name?1:e.name.localeCompare(t.name)})):null});case 9:case"end":return n.stop()}var l},n,this)}));return function(e,t){return n.apply(this,arguments)}}()},$=function(){return function(){var e=Object(O.a)(w.a.mark(function e(t){var n;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"teams/FETCH_PERMISSIONS_REQUESTED"}),e.next=3,J.getAnonymous().get("/admin/all-permissions").then(function(e){return e.data});case 3:n=e.sent,t({type:"teams/FETCH_PERMISSIONS_RECEIVED",permissions:n});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},ee=n(31),te={users:null,loading:!1,loadingUsers:!1,profile:null,permissions:{}},ne=function(){return function(){var e=Object(O.a)(w.a.mark(function e(t,n){var a,r,s;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),!a.user.loadingUsers){e.next=3;break}return e.abrupt("return");case 3:return t({type:"user/FETCH_USERS_REQUESTED"}),e.next=6,J.getSecured().get("/admin/users");case 6:r=e.sent,s=r.data,t({type:"user/FETCH_USERS_RECEIVED",users:s.payload});case 9:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},ae=function(){return function(){var e=Object(O.a)(w.a.mark(function e(t){var n,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"user/MY_PROFILE_REQUESTED"}),e.next=3,J.getSecured().get("/auth/me/profile");case 3:n=e.sent,a=n.data,t({type:"user/MY_PROFILE_RECEIVED",profile:a.payload});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},re=function(e){return function(){var t=Object(O.a)(w.a.mark(function t(n){var a,r;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:"user/MY_PERMISSIONS_REQUESTED"}),t.next=3,J.getSecured().get("/auth/me/permissions/".concat(e));case 3:a=t.sent,r=a.data,n({type:"user/MY_PERMISSIONS_RECEIVED",teamId:e,permissions:r.payload});case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},se={license:null,licensing:null},oe=function(){return function(){var e=Object(O.a)(w.a.mark(function e(t){var n;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getAnonymous().get("/admin/license").then(function(e){return e.data});case 2:n=e.sent,t({type:"license/FETCH_LICENSE_RECEIVED",license:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},ie=function(){return function(){var e=Object(O.a)(w.a.mark(function e(t){var n,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getSecured({toastErrors:!1}).get("admin/license/status");case 2:n=e.sent,a=n.data,t({type:"license/FETCH_LICENSING_RECEIVED",licensing:a.payload});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},le=n(186),ce=n.n(le),ue=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={isMenuOpen:!0},n.toggleMenu=function(){n.setState({isMenuOpen:!n.state.isMenuOpen})},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){!this.props.teams&&this.props.fetchTeams(),!this.props.profile&&this.props.fetchProfile(),!this.props.licensing&&this.props.fetchLicensing()}},{key:"renderProfileMenu",value:function(){var e=this;if(!this.props.profile)return null;var t=this.props.profile,n=t.username,a=t.fullName,s=this.props.licensing&&"ce"!==this.props.licensing.edition;return r.a.createElement(v.I,{nav:!0,inNavbar:!0},r.a.createElement(v.m,{nav:!0,caret:!0},r.a.createElement("span",{className:"user-profile"},r.a.createElement("img",{alt:"",src:this.props.profile.picture,className:"user-avatar"}),r.a.createElement("span",null,a||n))),r.a.createElement(v.l,{right:!0},r.a.createElement(v.k,{onClick:function(){return e.props.history.push("/profile")}},"My profile"),s&&r.a.createElement(v.k,{onClick:function(){return e.props.history.push("/license")}},"License"),r.a.createElement(v.k,{divider:!0}),r.a.createElement(v.k,{onClick:function(){return e.props.auth.logout()}},"Logout")))}},{key:"render",value:function(){return r.a.createElement(a.Fragment,null,r.a.createElement("header",{className:"bp-header"},r.a.createElement(v.C,{expand:"md"},r.a.createElement(v.D,{href:"/admin"},r.a.createElement("img",{src:ce.a,alt:"logo",className:"bp-header__logo"}),"\xa0|\xa0",r.a.createElement("span",{className:"bp-header__title"},"Admin")),r.a.createElement(v.E,{onClick:this.toggleMenu}),r.a.createElement(v.j,{isOpen:this.state.isMenuOpen,navbar:!0},r.a.createElement(v.z,{className:"ml-auto",navbar:!0},this.renderProfileMenu())))),this.renderUnlicensed(),r.a.createElement("div",{className:"bp-main-content"},this.props.children))}},{key:"renderUnlicensed",value:function(){return!this.props.licensing||"ce"===this.props.licensing.edition||"licensed"===this.props.licensing.status?null:r.a.createElement("div",{className:"bp-header__warning"},r.a.createElement(v.B,{href:"/admin/license"},r.a.createElement("svg",{viewBox:"0 0 90 82",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M88.21 65.042L54.084 5.932A10.53 10.53 0 0 0 44.99.682a10.53 10.53 0 0 0-9.094 5.25L1.467 65.568a10.532 10.532 0 0 0 0 10.5 10.53 10.53 0 0 0 9.094 5.25H79.44c5.79 0 10.5-4.71 10.5-10.5a10.458 10.458 0 0 0-1.73-5.776zm-8.771 9.275H10.561a3.51 3.51 0 0 1-3.031-1.75 3.51 3.51 0 0 1 0-3.5L41.96 9.433a3.509 3.509 0 0 1 3.031-1.75 3.51 3.51 0 0 1 3.031 1.75l34.184 59.208c.042.073.087.145.135.215.393.578.6 1.257.6 1.962a3.507 3.507 0 0 1-3.502 3.499zM45 54.93a3.912 3.912 0 0 0 3.912-3.912V30.687a3.912 3.912 0 0 0-7.824 0v20.331A3.912 3.912 0 0 0 45 54.93zm0 2.295c-1.32 0-2.601.53-3.54 1.46-.93.93-1.46 2.22-1.46 3.54 0 1.31.53 2.6 1.46 3.53a5.078 5.078 0 0 0 3.54 1.47c1.31 0 2.6-.54 3.53-1.47a5.002 5.002 0 0 0 1.47-3.53 5.003 5.003 0 0 0-5-5z",fill:"#FFF",fillRule:"nonzero"})),"Botpress is currently not licensed. Please update your license to re-enable all features."))}}]),t}(a.Component),me=Object(m.b)(function(e){return{teams:e.teams.items,currentTeamId:e.teams.teamId,currentTeam:e.teams.team,profile:e.user.profile,licensing:e.license.licensing}},function(e){return Object(b.b)({fetchProfile:ae,fetchTeams:Z,fetchLicensing:ie},e)})(ue),pe=n(79),de=n.n(pe),he=function(e){function t(){var e,n;Object(d.a)(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(o)))).state={username:"",password:"",passwordExpired:!1,error:null},n.login=Object(O.a)(w.a.mark(function e(){var t,a,r,s,o,i=arguments;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},a=t.username,r=t.password,s=t.showError,o=void 0===s||s,n.setState({error:null}),e.prev=2,e.next=5,n.props.auth.login({username:a||n.state.username,password:r||n.state.password});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),"PasswordExpiredError"===e.t0.type?(n.state.username&&n.state.password||n.setState({username:a,password:r}),n.setState({passwordExpired:!0})):o&&n.setState({error:e.t0.message});case 10:case"end":return e.stop()}},e,this,[[2,7]])})),n.onInputChange=function(e){return function(t){n.setState(Object(ee.a)({},e,t.target.value))}},n.onInputKeyPress=function(e){"Enter"===e.key&&n.login()},n.renderForm=function(){return n.state.passwordExpired?r.a.createElement(u.a,{to:{pathname:"/ChangePassword",state:n.state}}):r.a.createElement(a.Fragment,null,r.a.createElement(v.h,null,"Botpress Admin Panel"),r.a.createElement(v.g,null,"Login"),n.state.error&&r.a.createElement(v.a,{color:"danger"},n.state.error),r.a.createElement(v.o,null,r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement(v.p,{value:n.state.username,onChange:n.onInputChange("username"),type:"text",name:"username",id:"username",onKeyPress:n.onInputKeyPress})),r.a.createElement(v.o,null,r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(v.p,{value:n.state.password,onChange:n.onInputChange("password"),type:"password",name:"password",id:"password",onKeyPress:n.onInputKeyPress})),r.a.createElement("p",null,r.a.createElement(v.c,{onClick:n.login},"Sign in")))},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.login({username:"admin",password:"",showError:!1})}},{key:"render",value:function(){return this.props.auth.isAuthenticated()?r.a.createElement(u.a,{to:{pathname:"/"}}):r.a.createElement("div",{className:"centered-container"},r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement("img",{className:"logo",src:de.a,alt:"loading"}),r.a.createElement(v.e,{body:!0},r.a.createElement(v.f,{className:"login-box"},this.renderForm())))))}}]),t}(a.Component),fe=n(45),Ee=n(187),ge=n(29),ve=n(188),be=n.n(ve),ye=n(112),we=n(80),Oe=n.n(we),Ce=n(54),ke=n(2068),je=n(53),Me=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).checkPermissions=function(e,t){return!(!n.props.currentTeam||!n.props.currentUserPermissions)&&Object(je.checkRule)(n.props.currentUserPermissions,t,e)},n.renderBadge=function(e){return e&&n.isCommunity()?r.a.createElement(v.b,{color:"primary"},"Pro"):null},n.isCommunity=function(){return n.props.license&&"ce"===n.props.license.edition},n.state={menu:[],currentTeam:void 0},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchLicense(),this.generateMenu()}},{key:"componentDidUpdate",value:function(e){e!==this.props&&this.generateMenu()}},{key:"generateMenu",value:function(){var e=this.props.activePage,t=this.props.currentTeam&&this.props.currentTeam.id,n=[{title:"Users",active:"users"===e,show:!0,disabled:this.isCommunity(),link:"/users",isPro:!0},{title:"Teams",active:"teams"===e,show:!0,link:"/teams",subHeader:this.props.currentTeam&&this.props.currentTeam.name,childs:[{title:"Bots",active:"bots"===e,link:"/teams/".concat(t,"/bots"),show:this.checkPermissions("admin.team.bots","read")},{title:"Members",active:"members"===e,link:"/teams/".concat(t,"/members"),show:this.checkPermissions("admin.team.members","read"),isPro:!0},{title:"Roles",active:"roles"===e,link:"/teams/".concat(t,"/roles"),show:this.checkPermissions("admin.team.roles","read"),isPro:!0}]}];this.setState({menu:n})}},{key:"render",value:function(){var e=this,t=M.a.filter(this.state.menu,{show:!0});return r.a.createElement(v.C,null,r.a.createElement(v.z,{className:"bp-menu-aside-level1"},t.map(function(t){return r.a.createElement(v.A,{key:t.title,active:t.active},r.a.createElement(v.B,{className:"btn-sm",tag:ke.a,disabled:t.disabled,to:t.link},t.title," ",e.renderBadge(t.isPro)),e.renderSubMenu(t.childs,t.subHeader))})))}},{key:"renderSubMenu",value:function(e,t){var n=this,a=M.a.filter(e,{show:!0});return r.a.createElement(v.z,{className:"bp-menu-aside-level2"},t&&r.a.createElement("div",{className:"bp-menu-aside-level2__botname"},t),a.map(function(e){return r.a.createElement(v.A,{key:e.title,active:e.active},r.a.createElement(v.B,{className:"btn-sm",tag:ke.a,disabled:e.disabled||e.isPro&&n.isCommunity(),to:e.link},e.title," ",n.renderBadge(e.isPro)))}))}}]),t}(a.Component),Se=Object(m.b)(function(e){return{teams:e.teams.items,license:e.license.license,currentUserPermissions:e.user.permissions[e.teams.teamId]}},function(e){return Object(b.b)({fetchPermissions:re,fetchLicense:oe},e)})(Me),Pe=function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.helpText?r.a.createElement("span",null,r.a.createElement(ge.MdInfoOutline,{id:"sectionTitleHelp",className:"section-title-help"}),r.a.createElement(v.J,{placement:"right",target:"sectionTitleHelp"},this.props.helpText)):null;return r.a.createElement(a.Fragment,null,r.a.createElement("aside",{className:"bp-main-content-sidebar"},r.a.createElement(Se,{activePage:this.props.activePage,currentTeam:this.props.currentTeam})),r.a.createElement("div",{className:"bp-main-content-main"},r.a.createElement(v.F,null,r.a.createElement(v.i,{xs:12,md:10},r.a.createElement("h2",{className:"bp-main-content__title"},this.props.title,e)),r.a.createElement(v.i,{xs:12,md:2},this.props.sideMenu)),r.a.createElement(v.F,null,r.a.createElement(v.i,{xs:12,md:10},this.props.mainContent))))}}]),t}(a.Component),Te=n(189),Re=n.n(Te),xe=function(){return r.a.createElement(v.F,null,r.a.createElement(v.i,{className:"section",xs:12},r.a.createElement("div",{className:"middle"},r.a.createElement("img",{src:Re.a,alt:"loading"}))))},Ne=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={isEditBotModalOpen:!1,isCreateBotModalOpen:!1,errorCreateBot:void 0,errorEditBot:void 0,botTemplate:void 0,id:"",name:"",description:""},n.onInputKeyPress=function(e){return"Enter"===e.key&&n.createBot()},n.onBotNameChange=function(e){var t=e.target.value,a=t.toLowerCase().replace(/\s/g,"-").replace(/[$&+,:;=?@#|'<>.^*()%!]/g,"");n.setState({name:t,id:a})},n.createBot=Object(O.a)(w.a.mark(function e(){var t,a,r,s,o,i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.name,a=n.props.teamId,"-"===(r=n.state.id)[r.length-1]&&(r=r.slice(0,r.length-1)),s=Oe.a.validate({id:r,name:t,team:a},ye.BotCreationSchema),!(o=s.error)){e.next=9;break}return console.log(o),n.setState({errorCreateBot:o}),e.abrupt("return");case 9:return i=M.a.pick(n.state.botTemplate,["id","moduleId"]),e.next=12,J.getSecured().post("/admin/teams/".concat(a,"/bots"),{id:r,name:t,template:void 0!==i.id?i:void 0}).catch(function(e){return n.setState({errorCreateBot:e})});case 12:return e.next=14,n.props.fetchTeamData(n.props.teamId);case 14:n.toggleCreateBotModal();case 15:case"end":return e.stop()}},e,this)})),n.editBot=Object(O.a)(w.a.mark(function e(){var t,a,r,s,o;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state.id,a=n.state.name,r=n.state.description,s=Oe.a.validate({name:a,description:r},ye.BotEditSchema),!(o=s.error)){e.next=7;break}return n.setState({errorEditBot:o}),e.abrupt("return");case 7:return e.next=9,J.getSecured().put("/admin/teams/".concat(n.props.teamId,"/bots/").concat(t),{name:a,description:r}).catch(function(e){return n.setState({errorEditBot:e})});case 9:return e.next=11,n.props.fetchTeamData(n.props.teamId);case 11:n.toggleEditBotModal();case 12:case"end":return e.stop()}},e,this)})),n.toggleCreateBotModal=function(){n.setState({isCreateBotModalOpen:!n.state.isCreateBotModalOpen,id:"",name:""})},n.toggleEditBotModal=function(){var e=Object(O.a)(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.state.isEditBotModalOpen?n.setState({isEditBotModalOpen:!1,id:"",name:"",description:""}):n.setState({isEditBotModalOpen:!0,id:t.id,name:t.name,description:t.description});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.handleChangeTemplate=function(e){n.setState({botTemplate:e})},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"renderLoading",value:function(){return r.a.createElement(xe,null)}},{key:"componentDidMount",value:function(){this.props.fetchTeamData(this.props.teamId,{bots:!0}),this.props.fetchPermissions(this.props.teamId),this.props.fetchBotTemplates()}},{key:"componentDidUpdate",value:function(e){(this.props.bots||this.props.loading)&&e.teamId===this.props.teamId||this.props.fetchTeamData(this.props.teamId,{bots:!0}),e.teamId!==this.props.teamId&&this.props.fetchPermissions(this.props.teamId)}},{key:"renderCreateBot",value:function(){var e=this,t=[];this.props.botTemplates&&(t=M.a.uniq(this.props.botTemplates.map(function(e){return e.moduleName})).map(function(t){return{label:t,options:M.a.filter(e.props.botTemplates,function(e){return e.moduleName===t})}}));var n=[{id:void 0,name:"Empty Bot"}].concat(Object(fe.a)(t));if(!this.state.botTemplate){var a=M.a.head(n);this.setState({botTemplate:a.options?a.options[0]:a})}return r.a.createElement(v.v,{isOpen:this.state.isCreateBotModalOpen,toggle:this.toggleCreateBotModal},r.a.createElement(v.y,{toggle:this.toggleCreateBotModal},"Create a new bot"),r.a.createElement(v.w,null,r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"id"},r.a.createElement("strong",null,"Identifier")),r.a.createElement(v.p,{placeholder:"Auto-generated",disabled:!0,type:"text",id:"id",value:this.state.id})),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"name"},r.a.createElement("strong",null,"Bot Template")),r.a.createElement(Ce.a,{getOptionLabel:function(e){return e.name},getOptionValue:function(e){return e.id},options:n,value:this.state.botTemplate,onChange:this.handleChangeTemplate}),r.a.createElement("div",{className:"bot-template-desc"}," ",this.state.botTemplate&&this.state.botTemplate.desc)),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"name"},r.a.createElement("strong",null,"Name")),r.a.createElement(v.p,{type:"text",id:"name",value:this.state.name,invalid:this.state.errorCreateBot||!1,onKeyPress:this.onInputKeyPress,onChange:this.onBotNameChange}),r.a.createElement(v.n,null,"The bot name should have at least 4 characters."))),r.a.createElement(v.x,null,r.a.createElement(v.c,{color:"primary",onClick:this.createBot},"Create")))}},{key:"renderEditBot",value:function(){var e=this;return r.a.createElement(v.v,{isOpen:this.state.isEditBotModalOpen,toggle:this.toggleEditBotModal},r.a.createElement(v.y,{toggle:this.toggleEditBotModal},"Edit ",this.state.name),r.a.createElement(v.w,null,r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"name"},r.a.createElement("strong",null,"Name")),r.a.createElement(v.p,{type:"text",id:"name",value:this.state.name,invalid:this.state.errorEditBot||!1,onChange:function(t){return e.setState({name:t.target.value})}}),r.a.createElement(v.n,null,"The bot name should have at least 4 characters.")),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"description"},r.a.createElement("strong",null,"Description")),r.a.createElement(v.p,{type:"text",id:"description",value:this.state.description,invalid:this.state.errorEditBot||!1,onChange:function(t){return e.setState({description:t.target.value})}}),r.a.createElement(v.n,null,"The description should have at least 4 characters."))),r.a.createElement(v.x,null,r.a.createElement(v.c,{color:"primary",onClick:this.editBot},"Edit")))}},{key:"deleteBot",value:function(){var e=Object(O.a)(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete this bot? This can't be undone.")){e.next=5;break}return e.next=3,J.getSecured().delete("/admin/teams/".concat(this.props.teamId,"/bots/").concat(t));case 3:return e.next=5,this.props.fetchTeamData(this.props.teamId);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"renderEmptyBots",value:function(){return r.a.createElement("div",{className:"bots"},r.a.createElement(v.q,null,r.a.createElement(v.F,null,r.a.createElement(v.i,{style:{textAlign:"center"},sm:"12",md:{size:8,offset:2}},r.a.createElement("h1",null,r.a.createElement(Ee.IoIosBoxOutline,null),"\xa0 This team has no bot, yet."),r.a.createElement("p",null,"In Botpress, bots are always assigned to a team."),r.a.createElement("p",null,this.renderCreateNewBotButton(!0))))),this.renderCreateBot())}},{key:"renderCreateNewBotButton",value:function(e){var t=this;return r.a.createElement(v.c,{className:e?"":"float-right",onClick:function(){return t.setState({isCreateBotModalOpen:!0})},color:"primary",size:"sm"},r.a.createElement(ge.MdCreate,null)," Create Bot")}},{key:"renderBots",value:function(){var e=this,t=M.a.orderBy(this.props.bots,["id"],["desc"]);return t.length?r.a.createElement("div",{className:"bots"},r.a.createElement(v.F,null,r.a.createElement(v.i,{xs:12,md:8},this.renderCreateBot(),this.renderEditBot(),r.a.createElement(v.s,null,t.map(function(t){return r.a.createElement(v.t,{key:"bot-"+t.id},r.a.createElement(v.u,null,r.a.createElement("a",{className:"title",href:"/studio/".concat(t.id)},t.name)),r.a.createElement("span",null,t.description),r.a.createElement("div",{className:"list-group-item__actions"},r.a.createElement(v.c,{color:"link",onClick:function(){return e.toggleEditBotModal(t)}},"Edit"),r.a.createElement(v.c,{color:"link",onClick:function(){return e.deleteBot(t.id)}},"Delete")))}))))):this.renderEmptyBots()}},{key:"renderSideMenu",value:function(){return null}},{key:"render",value:function(){return this.props.loading||!this.props.bots?this.renderLoading():(setTimeout(function(){be()()},10),r.a.createElement(Pe,{title:"".concat(this.props.team.name,"'s bots"),helpText:"This page lists all the bots created under this team.",activePage:"bots",currentTeam:this.props.team,mainContent:this.renderBots(),sideMenu:this.renderCreateNewBotButton()}))}}]),t}(a.Component),Ie={fetchTeamData:X,fetchPermissions:re,fetchBotTemplates:function(){return function(){var e=Object(O.a)(w.a.mark(function e(t,n){var a,r;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"teams/FETCH_BOT_TEMPLATES_REQUESTED"}),e.next=3,J.getSecured().get("/modules/botTemplates");case 3:a=e.sent,r=a.data,t({type:"teams/FETCH_BOT_TEMPLATES_RECEIVED",botTemplates:r});case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}},_e=Object(m.b)(function(e){return{bots:e.teams.bots,teamId:e.teams.teamId,team:e.teams.team,loading:e.teams.loadingTeam,botTemplates:e.teams.botTemplates}},Ie)(Ne),Ue=n(56),De=n.n(Ue),Be=n(39),Ae=n.n(Be),Fe=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={isInit:!1,forceClose:!1,firstName:"",lastName:"",isDirty:!1},n.displayName=function(){var e=n.props.profile,t=e.firstname,a=void 0===t?"":t,r=e.lastname,s=void 0===r?"":r;n.setState({firstName:a,lastName:s})},n.closeModal=function(){n.setState({forceClose:!0})},n.isModalOpen=function(){return!n.state.forceClose&&!M.a.get(n.props,"profile.fullName")},n.onInputKeyPress=function(e){"Enter"===e.key&&n.updateProfile()},n.onInputChanged=function(e){var t;n.setState((t={},Object(ee.a)(t,e.target.name,e.target.value),Object(ee.a)(t,"isDirty",!0),t))},n.render=function(){return n.props.renderAsModal?n.renderModal():n.renderForm()},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.props.profile&&this.displayName()}},{key:"componentDidUpdate",value:function(e){!e.profile&&this.props.profile&&this.displayName()}},{key:"updateProfile",value:function(){var e=Object(O.a)(w.a.mark(function e(){var t=this;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getSecured().post("/auth/me/profile",{firstname:this.state.firstName,lastname:this.state.lastName});case 2:this.props.fetchProfile(),this.setState({forceClose:!0,successMsg:"Profile updated with success",isDirty:!1}),window.setTimeout(function(){t.setState({successMsg:void 0})},2e3);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderFields",value:function(){return r.a.createElement("div",null,r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"firstName"},"First Name"),r.a.createElement(v.p,{name:"firstName",onChange:this.onInputChanged,onKeyPress:this.onInputKeyPress,value:this.state.firstName})),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"lastName"},"Last Name"),r.a.createElement(v.p,{name:"lastName",onChange:this.onInputChanged,onKeyPress:this.onInputKeyPress,value:this.state.lastName})))}},{key:"renderForm",value:function(){return r.a.createElement("div",null,this.state.successMsg?r.a.createElement(v.a,{type:"success"},this.state.successMsg):"",this.renderFields(),this.renderSave())}},{key:"renderModal",value:function(){return r.a.createElement(v.v,{isOpen:this.isModalOpen(),toggle:this.closeModal},r.a.createElement(v.y,{toggle:this.closeModal},"Please complete your profile"),r.a.createElement(v.w,null,this.renderFields()),r.a.createElement(v.x,null,this.renderSave()))}},{key:"renderSave",value:function(){var e=this;return this.state.isDirty&&r.a.createElement(v.c,{color:"primary",onClick:function(){return e.updateProfile()}},"Save")}}]),t}(a.Component),Le=Object(m.b)(function(e){return{profile:e.user.profile}},function(e){return Object(b.b)({fetchProfile:ae},e)})(Fe),He=De.a.string().regex(/^[0-9A-Za-z _-]+$/).trim().min(3).max(30),Ke=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={isCreateTeamModalOpen:!1,canCreateTeam:!1,teamName:"",createTeamError:null},n.toggleCreateTeamModalOpen=function(){n.setState({isCreateTeamModalOpen:!n.state.isCreateTeamModalOpen})},n.onInputKeyPress=function(e){return"Enter"===e.key&&n.createTeam()},n.onTeamNameChange=function(e){var t=De.a.validate(e.target.value,He).error;n.setState({teamName:e.target.value,canCreateTeam:!t,createTeamError:t})},n.isCommunity=function(){return n.props.license&&"ce"===n.props.license.edition},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){!this.props.license&&this.props.fetchLicense(),!this.props.teams&&this.props.fetchTeams()}},{key:"componentDidUpdate",value:function(e){e.teams!==this.props.teams&&!this.props.teams&&this.props.fetchTeams()}},{key:"createTeam",value:function(){var e=Object(O.a)(w.a.mark(function e(){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getSecured().post("/admin/teams",{name:this.state.teamName});case 2:return this.setState({isCreateTeamModalOpen:!1,teamName:"",canCreateTeam:!1,createTeamError:null}),e.next=5,this.props.fetchTeams();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderCreateTeamModal",value:function(){var e=this;return r.a.createElement(v.v,{isOpen:this.state.isCreateTeamModalOpen,toggle:this.toggleCreateTeamModalOpen},r.a.createElement(v.y,{toggle:this.toggleCreateTeamModalOpen},"Create a new team"),r.a.createElement(v.w,null,r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"teamName"},"Team name"),r.a.createElement(v.p,{id:"teamName",onChange:this.onTeamNameChange,onKeyPress:this.onInputKeyPress,invalid:!!this.state.createTeamError,value:this.state.teamName}),!!this.state.createTeamError&&r.a.createElement(v.n,null,this.state.createTeamError.message))),r.a.createElement(v.x,null,r.a.createElement(v.c,{color:"primary",disabled:!this.state.canCreateTeam,onClick:function(){return e.createTeam()}},r.a.createElement(ge.MdGroupAdd,null)," Create")))}},{key:"renderAllTeams",value:function(){var e=this;return r.a.createElement(v.F,null,r.a.createElement(v.i,{xs:12,md:8},r.a.createElement(v.s,null,this.props.teams.map(function(t){var n=Ae()(t.createdAt).fromNow();return r.a.createElement(v.t,{tag:"a",key:t.id,action:!0,href:"#",onClick:function(){return e.props.history.push("/teams/".concat(t.id))}},r.a.createElement(v.u,null,t.name),r.a.createElement("small",null,"Created ",n))}))))}},{key:"renderCreateTeamButton",value:function(){if(!this.isCommunity())return r.a.createElement(v.c,{className:"float-right",color:"primary",size:"sm",onClick:this.toggleCreateTeamModalOpen},r.a.createElement(ge.MdGroupAdd,null)," Create team")}},{key:"renderSideMenu",value:function(){return r.a.createElement("div",null,this.renderCreateTeamButton(),this.renderCreateTeamModal(),r.a.createElement(Le,{renderAsModal:"true"}))}},{key:"render",value:function(){return r.a.createElement(Pe,{title:"My teams",helpText:"These are the teams you are a member of. You can join an existing team by asking someone you know, or you can create your own team and invite others to collaborate with you.",activePage:"teams",mainContent:!this.props.teams||this.props.loading?r.a.createElement(xe,null):this.renderAllTeams(),sideMenu:this.renderSideMenu()})}}]),t}(a.Component),ze=Object(m.b)(function(e){return{teams:e.teams.items,loading:e.teams.loadingTeams,license:e.license.license}},function(e){return Object(b.b)({fetchLicense:oe,fetchTeams:Z},e)})(Ke),Ve=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={needRefresh:!1},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchUsers()}},{key:"componentDidUpdate",value:function(){this.state.needRefresh&&(this.props.fetchUsers(),this.setState({needRefresh:!1}))}},{key:"renderUsers",value:function(){var e=this,t="true"===this.props.detailed?{}:{display:"none"};return r.a.createElement("div",{className:"users"},r.a.createElement(v.G,{className:"table bp-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Username"),r.a.createElement("th",null,"Name"),r.a.createElement("th",{style:t},"Created at"),r.a.createElement("th",{style:t},"Last Logon"),r.a.createElement("th",null,"Actions"))),r.a.createElement("tbody",null,this.props.users&&this.props.users.map(function(n){return e.props.ignoreUsers&&-1!==e.props.ignoreUsers.indexOf(n.id)?null:r.a.createElement("tr",{key:n.id},r.a.createElement("td",null,n.username),r.a.createElement("td",{className:"table-cell--ellipsis"},n.firstname,"\xa0",n.lastname),r.a.createElement("td",{style:t},Ae()(n.created_at).format("lll")),r.a.createElement("td",{style:t},n.last_logon?Ae()(n.last_logon).fromNow():"never"),r.a.createElement("td",null,e.props.actions.map(function(t,a){return r.a.createElement(v.c,{color:t.type?t.type:"link",size:"sm",key:a,onClick:function(){t.onClick(n),t.needRefresh&&e.setState({needRefresh:!0})}},t.label)})))}))))}},{key:"render",value:function(){return!this.props.users||this.props.loading?r.a.createElement(xe,null):this.renderUsers()}}]),t}(a.Component),Ye=Object(m.b)(function(e){return{users:e.user.items,loading:e.user.loadingUsers}},function(e){return Object(b.b)({fetchUsers:ne},e)})(Ve),Qe=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={isAddUsersModalOpen:!1,changeRoleMember:null,newUserRole:""},n.toggleAddUsers=function(){n.setState({isAddUsersModalOpen:!n.state.isAddUsersModalOpen})},n.fetchTeamData=function(){n.props.fetchTeamData(n.props.teamId,{members:!0,roles:!0})},n.removeMember=function(){var e=Object(O.a)(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to remove this member form the team? This can't be undone.")){e.next=5;break}return e.next=3,J.getSecured().delete("/admin/teams/".concat(n.props.teamId,"/members/").concat(t));case 3:return e.next=5,n.props.fetchTeamData(n.props.teamId);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.onCopy=function(){n.setState({copied:!0}),window.setTimeout(function(){n.setState({copied:!1})},750)},n.addMember=function(){var e=Object(O.a)(w.a.mark(function e(t){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getSecured().post("/admin/teams/".concat(n.props.teamId,"/members/").concat(t.username),{role:"default"});case 2:return e.next=4,n.props.fetchTeamData(n.props.teamId);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.currentUserHasPermission=function(e,t){return!!n.props.currentUserPermissions&&Object(je.checkRule)(n.props.currentUserPermissions,t,e)},n.changeMemberRole=function(){var e=n.state.changeRoleMember,t=n.state.newUserRole;J.getSecured().patch("/admin/teams/".concat(n.props.teamId,"/members/").concat(e.username),{role:t}).then(function(){n.setState({changeRoleMember:null,newUserRole:""})}).then(n.fetchTeamData)},n.openChangeMemberRole=function(e){return function(){"owner"!==e.role&&n.setState({changeRoleMember:e,newUserRole:e.role})}},n.toggleChangeMemberRole=function(){n.setState(function(e){return{changeRoleMember:!e.changeRoleMember}})},n.onNewUserRoleChange=function(e){var t=e.value;n.setState({newUserRole:t})},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"renderLoading",value:function(){return r.a.createElement(xe,null)}},{key:"componentDidMount",value:function(){this.fetchTeamData(),this.props.fetchPermissions(this.props.teamId)}},{key:"componentDidUpdate",value:function(e){(this.props.members||this.props.loading)&&e.teamId===this.props.teamId||this.fetchTeamData(),e.teamId!==this.props.teamId&&this.props.fetchPermissions(this.props.teamId)}},{key:"renderAddUserModal",value:function(){var e=this,t=M.a.map(this.props.members,"id"),n=[{label:"Add",type:"primary",needRefresh:!0,onClick:function(t){return e.addMember(t)}}];return r.a.createElement(v.v,{isOpen:this.state.isAddUsersModalOpen,toggle:this.toggleAddUsers},r.a.createElement(v.y,{toggle:this.toggleAddUsers},"Add users to this team"),r.a.createElement(v.w,null,r.a.createElement(Ye,{actions:n,detailed:"false",ignoreUsers:t,refresh:this.refreshUsers})))}},{key:"renderMemberMenu",value:function(e){var t=this,n=[];return this.currentUserHasPermission("admin.team.members","write")&&("owner"===e.role?n.push(r.a.createElement(v.c,{key:"remove",color:"link",className:"text-muted disabled",title:"You cannot remove the team owner",onClick:function(){return alert("You cannot remove the team owner.")}},"Remove")):n.push(r.a.createElement(v.c,{key:"remove",color:"link",onClick:function(){return t.removeMember(e.username)}},"Remove"))),n.length?r.a.createElement(a.Fragment,null,n):null}},{key:"renderMemberRole",value:function(e){var t=Object(j.find)(this.props.roles,{name:e.role}),n=[t&&t.description,"owner"!==e.role&&"Click to change."].filter(Boolean).join(". ");return r.a.createElement("abbr",{"data-title":n,onClick:this.openChangeMemberRole(e)},e.role||r.a.createElement("em",null,"(no role)"))}},{key:"renderChangeUserRoleModal",value:function(){if(!this.props.roles)return null;var e=this.state.changeRoleMember,t=[{label:r.a.createElement("em",null,"(no role)"),value:""}].concat(this.props.roles.map(function(e){var t=e.name;return{label:t,value:t}})).filter(function(t){var n=t.value;return"owner"!==n&&n!==(e&&e.role)});return r.a.createElement(v.v,{isOpen:!!e,toggle:this.toggleChangeMemberRole},r.a.createElement(v.y,{toggle:this.toggleChangeMemberRole},"Change role for user ",e&&e.username),r.a.createElement(v.w,null,r.a.createElement(Ce.a,{options:t,value:this.state.newUserRole,onChange:this.onNewUserRoleChange})),r.a.createElement(v.x,null,r.a.createElement(v.c,{color:"primary",onClick:this.changeMemberRole},"Save")))}},{key:"renderMembers",value:function(){var e=this,t=this.props.members;return r.a.createElement("div",{className:"members"},r.a.createElement(v.F,null,r.a.createElement(v.i,{xs:12,md:8},r.a.createElement(v.s,null,t.map(function(t){var n=Ae()(t.joinedAt).fromNow();return r.a.createElement(v.t,{key:"user-".concat(t.id)},r.a.createElement(v.u,null,r.a.createElement("img",{className:"list-group-item__avatar",alt:"",width:"32",height:"32",src:t.picture}),r.a.createElement("span",{className:"title"},t.username)),r.a.createElement("div",{className:"list-group-item__actions"},e.renderMemberMenu(t)),r.a.createElement("small",null,r.a.createElement("b",null,"Role:")," ",e.renderMemberRole(t)," | ",r.a.createElement("b",null,"Username:")," ",t.username," | Joined"," ",n))})),this.renderChangeUserRoleModal(),this.renderAddUserModal())))}},{key:"renderSideMenu",value:function(){return this.currentUserHasPermission("admin.team.members","write")?r.a.createElement(v.c,{className:"float-right",color:"primary",size:"sm",onClick:this.toggleAddUsers},r.a.createElement(ge.MdPersonAdd,null)," Add Users"):null}},{key:"render",value:function(){return this.props.loading||!this.props.members?this.renderLoading():r.a.createElement(Pe,{title:"".concat(this.props.team.name,"'s members"),activePage:"members",currentTeam:this.props.team,mainContent:this.renderMembers(),sideMenu:this.renderSideMenu()})}}]),t}(a.Component),Ge=Object(m.b)(function(e){return{members:e.teams.members,roles:e.teams.roles,teamId:e.teams.teamId,team:e.teams.team,loading:e.teams.loadingTeam,currentUser:e.user.profile,currentUserPermissions:e.user.permissions[e.teams.teamId]}},function(e){return Object(b.b)({fetchTeamData:X,fetchPermissions:re},e)})(Qe),Je=function(e){return e?"+":"-"},qe=function(e){return[null!=e.r?"".concat(Je(e.r),"r"):null,null!=e.w?"".concat(Je(e.w),"w"):null].filter(Boolean).join("")},We=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={},n.onChange=function(e){return function(t){n.setState({op:Object(C.a)({},n.state.op,Object(ee.a)({},e,t.target.checked))},function(){n.props.onChange&&n.props.onChange(qe(n.state.op))})}},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.state.op,t=this.props,n=t.index,a=t.total,s=t.ruleInfo,o=t.rule,i=t.readOnly;return r.a.createElement(v.F,{className:"actions-table-row"},r.a.createElement(v.i,{sm:"5"},r.a.createElement("abbr",{"data-title":s.description||""},r.a.createElement("code",null,o.res))),r.a.createElement(v.i,{sm:"2"},null!=e.r&&r.a.createElement(v.o,{check:!0},r.a.createElement(v.r,{check:!0},r.a.createElement(v.p,{type:"checkbox",checked:e.r,onChange:this.onChange("r"),disabled:i})," read"))),r.a.createElement(v.i,{sm:"2"},null!=e.w&&r.a.createElement(v.o,{check:!0},r.a.createElement(v.r,{check:!0},r.a.createElement(v.p,{type:"checkbox",checked:e.w,onChange:this.onChange("w"),disabled:i})," write"))),!i&&r.a.createElement("div",{className:"actions-table-row__buttons ml-auto"},r.a.createElement(v.d,null,r.a.createElement(v.c,{onClick:this.props.onMoveUp,size:"sm",outline:!0,disabled:n<1},r.a.createElement(ge.MdArrowDropUp,{className:"btn__icon"})),r.a.createElement(v.c,{onClick:this.props.onMoveDown,size:"sm",outline:!0,disabled:n>a-2},r.a.createElement(ge.MdArrowDropDown,{className:"btn__icon"}))),r.a.createElement(v.c,{onClick:this.props.onDelete,color:"link"},r.a.createElement(ge.MdDelete,{className:"btn__icon"}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.rule&&e.rule!==t.rule?{rule:e.rule,op:function(e){var t={r:null,w:null};if(e.length<2||e.length>4)return t;var n=[];return 2===e.length?n=[{op:e[1],allowed:e[0]}]:3===e.length?n=[{op:e[1],allowed:e[0]},{op:e[2],allowed:e[0]}]:4===e.length&&(n=[{op:e[1],allowed:e[0]},{op:e[3],allowed:e[2]}]),n.forEach(function(e){var n=e.op,a=e.allowed;t[n]="+"===a}),t}(e.rule.op)}:null}}]),t}(a.Component),Ze=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={indexedPermissions:null},n.onDelete=function(){window.confirm("Are you sure you want to delete this role? This can't be undone.")&&n.props.onDelete()},n.onEdit=function(){},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"renderMenu",value:function(){if(this.props.readOnly)return null;var e="owner"===this.props.role.name?r.a.createElement(v.c,{className:"text-muted disabled",color:"link",title:"You cannot remove the team owner role",onClick:function(){return alert("You cannot remove the team owner role.")}},"Delete"):r.a.createElement(v.c,{key:"remove",color:"link",onClick:this.onDelete},"Delete");return r.a.createElement("div",{className:"list-group-item__actions"},r.a.createElement(v.c,{onClick:this.props.onEdit,color:"link"},"Edit"),e)}},{key:"render",value:function(){var e=this.props.role;if(!e)return null;var t=this.state.indexedPermissions;return r.a.createElement(v.t,null,r.a.createElement(v.u,null,e.name),this.renderMenu(),e.description&&r.a.createElement("small",null,e.description),e.rules&&e.rules.length&&r.a.createElement(a.Fragment,null,r.a.createElement("p",{className:"list-group-item__permissions"},"Role Permissions:"),e.rules.map(function(n,a){return r.a.createElement(We,{index:a,total:e.rules.length,readOnly:!0,rule:n,ruleInfo:t&&t[n.res]||{},key:"".concat(a,".").concat(n.res,".").concat(n.op)})})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.existingPermissions&&!t.indexedPermissions?{indexedPermissions:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?(t.forEach(function(t){n[t.name]=t,e(t.children,n)}),n):n}(e.existingPermissions)}:null}}]),t}(a.Component),Xe={name:"",description:"",rules:[]},$e=function(e){return e.operations?"-".concat(e.operations.join("")):""},et=function(e){return JSON.stringify(e)},tt=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={role:null,originalRole:null,roleHash:null,newRuleResource:null},n.onRuleOpChange=function(e){return function(t){n.setState(function(a){var r=a.role,s=Object(fe.a)(r.rules);return s[e].op=t,{role:Object(C.a)({},n.state.role,{rules:s})}})}},n.onDescChange=function(e){var t=e.target.value;n.setState(function(e){var n=e.role;return{role:Object(C.a)({},n,{description:t})}})},n.onNameChange=function(e){var t=e.target.value;n.setState(function(e){var n=e.role;return{role:Object(C.a)({},n,{name:t})}})},n.onRuleDelete=function(e){return function(){n.setState(function(t){var a=t.role,r=Object(fe.a)(a.rules);return r.splice(e,1),{role:Object(C.a)({},n.state.role,{rules:r})}})}},n.onRuleUp=function(e){return function(){e<1||n.setState(function(t){var a=t.role,r=Object(fe.a)(n.state.role.rules),s=r[e];return r[e]=r[e-1],r[e-1]=s,{role:Object(C.a)({},a,{rules:r})}})}},n.onRuleDown=function(e){return function(){e>n.props.total-2||n.setState(function(t){var a=t.role,r=Object(fe.a)(a.rules),s=r[e];return r[e]=r[e+1],r[e+1]=s,{role:Object(C.a)({},n.state.role,{rules:r})}})}},n.onRuleAdd=function(){n.state.newRuleResource&&n.setState(function(e){var t=e.role,n=e.newRuleResource,a=e.indexedPermissions,r={res:n,op:$e(a[n])},s=Object(fe.a)(t.rules).concat([r]);return{role:Object(C.a)({},t,{rules:s}),newRuleResource:null}})},n.onDelete=function(){window.confirm("Are you sure you want to delete this role? This can't be undone.")&&n.props.onDelete()},n.onReset=function(){n.setState(function(e){return{role:e.originalRole}})},n.onClose=function(){n.setState({role:null,originalRole:null,roleHash:null,newRuleResource:null}),n.props.onClose&&n.props.onClose()},n.onSave=function(){n.canSave()&&(n.props.onSave(n.state.role),n.setState({role:null,originalRole:null,roleHash:null,newRuleResource:null}))},n.changeNewRule=function(e){var t=e.value;n.setState({newRuleResource:t})},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"isDirty",value:function(){return this.state.roleHash!==et(this.state.role)}},{key:"canSave",value:function(){return!(!this.isDirty()||this.props.readOnly)&&!(this.props.createMode&&!this.state.role.name)}},{key:"renderMenu",value:function(){if(this.props.readOnly)return null;var e=this.isDirty(),t=this.canSave();return r.a.createElement(a.Fragment,null,r.a.createElement(v.c,{onClick:this.onClose,outline:!0},"Cancel"),r.a.createElement(v.c,{onClick:this.onReset,outline:!0,disabled:!e},"Reset changes"),r.a.createElement(v.c,{onClick:this.onSave,disabled:!t,color:"primary"},"","Save"))}},{key:"renderAddRule",value:function(){var e=this;if(!this.state.permissionOptions||this.props.readOnly)return null;var t=this.state.permissionOptions.filter(function(t){var n=t.value;return!Object(j.find)(e.state.role.rules,{res:n})});return r.a.createElement(v.F,null,r.a.createElement(v.i,{sm:"9",md:"10"},r.a.createElement(Ce.a,{value:this.state.newRuleResource,onChange:this.changeNewRule,options:t})),r.a.createElement(v.i,{sm:"3",md:"2",className:"text-right"},r.a.createElement(v.c,{color:"secondary",onClick:this.onRuleAdd},"Add")))}},{key:"render",value:function(){var e=this,t=this.state,n=t.role,a=t.indexedPermissions,s=this.props,o=s.createMode,i=s.readOnly;return n?r.a.createElement(v.v,{isOpen:this.props.show,toggle:this.props.onClose},r.a.createElement(v.y,{toggle:this.props.onClose},o?"New Role":n.name),r.a.createElement(v.w,null,o&&r.a.createElement(v.o,null,r.a.createElement("label",null,r.a.createElement("strong",null,"Role Title")),r.a.createElement(v.p,{id:"inputName",value:n.name||"",onChange:this.onNameChange})),r.a.createElement(v.o,null,r.a.createElement("label",null,r.a.createElement("strong",null,"Role Description")),i?n.description||"":r.a.createElement(v.p,{id:"inputDescripton",value:n.description||"",onChange:this.onDescChange})),r.a.createElement(v.o,null,r.a.createElement("label",null,r.a.createElement("strong",null,"Role Permissions")),this.renderAddRule()),n.rules.map(function(t,s){return r.a.createElement(We,{index:s,total:n.rules.length,readOnly:i,rule:t,ruleInfo:a&&a[t.res]||{},onMoveUp:e.onRuleUp(s),onMoveDown:e.onRuleDown(s),onDelete:e.onRuleDelete(s),onChange:e.onRuleOpChange(s),key:"".concat(s,".").concat(t.res,".").concat(t.op)})})),r.a.createElement(v.x,null,this.renderMenu())):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=!1,a={};return!0===e.createMode?t.role||(n=!0,Object.assign(a,{originalRole:Xe,role:Xe,roleHash:et(Xe)})):!1===e.createMode&&e.role&&e.role!==t.originalRole&&(n=!0,Object.assign(a,{originalRole:e.role,role:e.role,roleHash:et(e.role)})),e.existingPermissions&&!t.existingPermissions&&(n=!0,Object.assign(a,{existingPermissions:e.existingPermissions,indexedPermissions:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t?(t.forEach(function(t){n[t.name]=t,e(t.children,n)}),n):n}(e.existingPermissions),permissionOptions:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t?(t.forEach(function(t){t.operations&&t.operations.length&&n.push({label:t.name,value:t.name}),e(t.children,n,a+"  ")}),n):n}(e.existingPermissions)})),n?a:null}}]),t}(a.Component),nt=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={roleToEdit:null,createNewRole:!1},n.fetchRoles=function(){n.props.fetchTeamData(n.props.teamId,{roles:!0})},n.currentUserHasPermission=function(e,t){return!!n.props.currentUserPermissions&&Object(je.checkRule)(n.props.currentUserPermissions,t,e)},n.onRoleCreate=function(e){return e=Object(j.pick)(e,"name","description","rules"),J.getSecured().post("/admin/teams/".concat(n.props.teamId,"/roles"),e).then(n.onRoleEditDone).then(n.fetchRoles)},n.onRoleChange=function(e){var t=e.id;e=Object(j.pick)(e,"name","description","rules"),J.getSecured().patch("/admin/teams/".concat(n.props.teamId,"/roles/").concat(t),e).then(n.onRoleEditDone).then(n.fetchRoles)},n.onRoleEditStart=function(e){return function(){n.setState({roleToEdit:e,createNewRole:!1})}},n.onRoleEditDone=function(){n.setState({roleToEdit:null,createNewRole:!1})},n.onRoleCreateStart=function(){n.setState({roleToEdit:null,createNewRole:!0})},n.onRoleDelete=function(e){return function(){J.getSecured().delete("/admin/teams/".concat(n.props.teamId,"/roles/").concat(e)).then(n.fetchRoles)}},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"renderLoading",value:function(){return r.a.createElement(xe,null)}},{key:"componentDidMount",value:function(){this.fetchRoles(),this.props.fetchExistingPermissions(),this.props.fetchPermissions(this.props.teamId)}},{key:"componentDidUpdate",value:function(e){(this.props.roles||this.props.loading)&&e.teamId===this.props.teamId||this.fetchRoles(),e.teamId!==this.props.teamId&&this.props.fetchPermissions(this.props.teamId)}},{key:"renderBody",value:function(){var e=this,t=this.props,n=t.roles,a=t.existingPermissions,s=this.state,o=s.roleToEdit,i=s.createNewRole;return r.a.createElement(v.F,null,r.a.createElement(v.i,{xs:12,md:8},r.a.createElement(v.s,null,n.map(function(t){return r.a.createElement(Ze,{role:t,readOnly:"owner"===t.name,existingPermissions:a,onEdit:e.onRoleEditStart(t),onDelete:e.onRoleDelete(t.id),key:t.id})}),r.a.createElement(tt,{show:!!o||i,role:o,createMode:i,existingPermissions:a,onSave:i?this.onRoleCreate:this.onRoleChange,onClose:this.onRoleEditDone}))))}},{key:"renderSideMenu",value:function(){return this.currentUserHasPermission("admin.team.roles","write")?r.a.createElement(v.c,{className:"float-right",color:"primary",size:"sm",onClick:this.onRoleCreateStart},r.a.createElement(ge.MdPersonAdd,null)," Add role"):null}},{key:"render",value:function(){return this.props.loading||!this.props.roles?this.renderLoading():r.a.createElement(Pe,{title:"".concat(this.props.team.name,"'s roles"),helpText:"Permissions lower in the list have higher precedence.",activePage:"roles",currentTeam:this.props.team,mainContent:this.renderBody(),sideMenu:this.renderSideMenu()})}}]),t}(a.Component),at=Object(m.b)(function(e){return{roles:e.teams.roles,teamId:e.teams.teamId,team:e.teams.team,loading:e.teams.loadingTeam,existingPermissions:e.teams.permissions,currentUser:e.user.profile,currentUserPermissions:e.user.permissions[e.teams.teamId]}},function(e){return Object(b.b)({fetchTeamData:X,fetchPermissions:re,fetchExistingPermissions:$},e)})(nt),rt=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={isModalOpen:!1,password:"",newPassword:"",confirmPassword:"",error:void 0},n.toggleModal=function(){n.setState({isModalOpen:!n.state.isModalOpen})},n.onInputKeyPress=function(e){"Enter"===e.key&&n.changePassword()},n.onInputChange=function(e){n.setState(Object(ee.a)({},e.target.name,e.target.value))},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"changePassword",value:function(){var e=Object(O.a)(w.a.mark(function e(){var t=this;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.newPassword===this.state.confirmPassword){e.next=3;break}return this.setState({error:"Passwords don't match"}),e.abrupt("return");case 3:return e.next=5,J.getSecured().post("/auth/login",{username:this.props.profile.username,password:this.state.password,newPassword:this.state.newPassword}).then(function(){return t.toggleModal()}).catch(function(e){return t.setState({error:e.message})});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderModal",value:function(){var e=this;return r.a.createElement(v.v,{isOpen:this.state.isModalOpen,toggle:this.toggleModal},r.a.createElement(v.y,{toggle:this.toggleModal},"Change your password"),r.a.createElement(v.w,null,this.state.error&&r.a.createElement(v.a,{color:"danger"},this.state.error),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"firstName"},"Current Password"),r.a.createElement(v.p,{name:"password",type:"password",onChange:this.onInputChange,onKeyPress:this.onInputKeyPress,value:this.state.firstName})),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"lastName"},"New Password"),r.a.createElement(v.p,{value:this.state.newPassword,type:"password",name:"newPassword",onChange:this.onInputChange,onKeyPress:this.onInputKeyPress})),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"lastName"},"Confirm Password"),r.a.createElement(v.p,{value:this.state.confirmPassword,type:"password",name:"confirmPassword",onChange:this.onInputChange,onKeyPress:this.onInputKeyPress}))),r.a.createElement(v.x,null,r.a.createElement(v.c,{color:"primary",onClick:function(){return e.changePassword()}},"Change")))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(v.c,{color:"primary",size:"sm",onClick:this.toggleModal},"Change Password"),this.renderModal())}}]),t}(a.Component),st=Object(m.b)(function(e){return{profile:e.user.profile}})(rt),ot=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!1},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"renderBody",value:function(){return r.a.createElement(v.F,{className:"profile"},r.a.createElement(v.i,{sm:"12",md:"3"},r.a.createElement("div",{className:"profile__avatar"}),r.a.createElement(st,null)),r.a.createElement(v.i,{sm:"12",md:"6"},r.a.createElement(Le,null)))}},{key:"render",value:function(){return r.a.createElement(Pe,{title:"Profile",activePage:"profile",mainContent:this.state.loading?r.a.createElement(xe,null):this.renderBody()})}}]),t}(a.Component),it=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).login=Object(O.a)(w.a.mark(function e(){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({error:null}),n.state.newPassword===n.state.confirmPassword){e.next=4;break}return n.setState({error:"Passwords don't match"}),e.abrupt("return");case 4:return e.prev=4,e.next=7,n.props.auth.login({username:n.state.username,password:n.state.password,newPassword:n.state.newPassword});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),n.setState({error:e.t0.message});case 12:case"end":return e.stop()}},e,this,[[4,9]])})),n.onInputChange=function(e){return function(t){n.setState(Object(ee.a)({},e,t.target.value))}},n.onInputKeyPress=function(e){"Enter"===e.key&&n.login()},n.getReasonText=function(){return""===n.state.password?"This is the first time you run Botpress. Please pick a password.":"Your password has expired or was temporary. Please set a new password."},n.renderForm=function(){return n.state.username?r.a.createElement(a.Fragment,null,r.a.createElement(v.h,null,"Botpress Admin Panel"),r.a.createElement(v.g,null,n.getReasonText()),n.state.error&&r.a.createElement(v.a,{color:"danger"},n.state.error),r.a.createElement(v.o,null,r.a.createElement("label",{htmlFor:"newPassword"},"Password"),r.a.createElement(v.p,{value:n.state.newPassword,onChange:n.onInputChange("newPassword"),type:"password",name:"newPassword",id:"newPassword",onKeyPress:n.onInputKeyPress})),r.a.createElement(v.o,null,r.a.createElement("label",{htmlFor:"confirmPassword"},"Confirm password"),r.a.createElement(v.p,{value:n.state.confirmPassword,onChange:n.onInputChange("confirmPassword"),type:"password",name:"confirmPassword",id:"confirmPassword",onKeyPress:n.onInputKeyPress})),r.a.createElement("p",null,r.a.createElement(v.c,{onClick:n.login},"Change"))):r.a.createElement(u.a,{to:"/"})},n.state=Object(C.a)({},e.location.state,{newPassword:"",confirmPassword:""}),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return this.props.auth.isAuthenticated()?r.a.createElement(u.a,{to:{pathname:"/"}}):r.a.createElement("div",{className:"centered-container"},r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement("img",{className:"logo",src:de.a,alt:"loading"}),r.a.createElement(v.e,{body:!0},r.a.createElement(v.f,{className:"login-box"},this.renderForm())))))}}]),t}(a.Component),lt=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).displayPolicies=function(){var e=n.props.license,t=e.seats,a=e.versions,r=e.edition,s=e.startDate,o=e.endDate;n.setState({policies:[]}),n.addPolicy("Admins",t,n.getBreach("studio seats")),n.addPolicy("Version",a,n.getBreach("version")),n.addPolicy("Edition",r,n.getBreach("edition")),n.addPolicy("Start Date",Ae()(s).format("YYYY-MM-DD"),n.getBreach("date")),n.addPolicy("End Date",Ae()(o).format("YYYY-MM-DD"),n.getBreach("date")),n.addPolicy("Server Fingerprint","",n.getBreach("fingerprint"))},n.addPolicy=function(e,t,a){n.setState(function(n){return{policies:Object(fe.a)(n.policies).concat([{name:e,status:t,breachError:a}])}})},n.state={policies:[],breachs:[]},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.displayPolicies()}},{key:"componentDidUpdate",value:function(e){e.license!==this.props.license&&this.displayPolicies()}},{key:"getBreach",value:function(e){if(this.props.breachs){var t=!0,n=!1,a=void 0;try{for(var r,s=this.props.breachs[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var o=r.value;if(-1!==o.toLowerCase().indexOf(e))return o}}catch(i){n=!0,a=i}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}}}},{key:"render",value:function(){return r.a.createElement("table",{className:"table bp-table"},r.a.createElement("tbody",null,this.state.policies.map(function(e,t){return r.a.createElement("tr",{key:t,title:e.breachError},r.a.createElement("td",null,e.breachError?r.a.createElement("span",{role:"img","aria-label":"Breached"},"\u274c"):r.a.createElement("span",{className:"bp-table__check"},"\u2713")),r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.status))})))}}]),t}(r.a.Component),ct=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={isModalOpen:!1,licenseKey:void 0,error:void 0},n.toggleModal=function(){n.setState({isModalOpen:!n.state.isModalOpen,licenseKey:void 0,error:void 0})},n.onInputKeyPress=function(e){"Enter"===e.key&&n.changeKey()},n.onInputChange=function(e){n.setState(Object(ee.a)({},e.target.name,e.target.value))},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"changeKey",value:function(){var e=Object(O.a)(w.a.mark(function e(){var t=this;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getSecured().post("admin/license/update",{licenseKey:this.state.licenseKey},{timeout:1e4}).then(function(){t.props.refresh&&t.props.refresh(),t.toggleModal()}).catch(function(e){return t.setState({error:e.message})});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderModal",value:function(){var e=this;return r.a.createElement(v.v,{isOpen:this.state.isModalOpen,toggle:this.toggleModal},r.a.createElement(v.y,{toggle:this.toggleModal},"Enter your license key"),r.a.createElement(v.w,null,this.state.error&&r.a.createElement(v.a,{color:"danger"},this.state.error),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"firstName"},"New License Key"),r.a.createElement(v.p,{name:"licenseKey",type:"textarea",style:{height:180},onChange:this.onInputChange,onKeyPress:this.onInputKeyPress,value:this.state.licenseKey,autoFocus:!0}))),r.a.createElement(v.x,null,r.a.createElement(v.c,{color:"primary",onClick:function(){return e.changeKey()}},"Validate & Change")))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(v.c,{size:"sm",color:"primary",outline:!0,onClick:this.toggleModal},"Enter License Key"),this.renderModal())}}]),t}(a.Component),ut=n(81),mt=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).displayStatus=function(){var e=n.props.licensing,t=e.license,a=e.status,r=t.fingerprint,s=t.paidUntil,o=t.support;n.setState({isLicensed:"licensed"===a,isUnderLimits:"breached"!==a,licenseFingerprint:r,renewDate:Ae()(s).format("lll"),supportLevel:o})},n.toggle=function(){n.setState({tooltipOpen:!n.state.tooltipOpen})},n.state={loading:!1,isLicensed:!1,isUnderLimits:!0,serverFingerprint:"",paidUntil:void 0,supportLevel:"none",tooltipOpen:!1},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchLicensing()}},{key:"componentDidUpdate",value:function(e){this.props.licensing!==e.licensing&&(this.props.licensing.license&&this.displayStatus(),this.setState({serverFingerprint:this.props.licensing.fingerprint}))}},{key:"refreshKey",value:function(){var e=Object(O.a)(w.a.mark(function e(){var t=this;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getSecured().post("/admin/license/refresh",{licenseKey:this.state.licenseKey}).then(function(){return t.props.fetchLicensing()});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderLicenseStatus",value:function(){var e=this;return r.a.createElement("div",{className:"license-status "+(this.state.isLicensed?"licensed":"unlicensed")},r.a.createElement("div",null,r.a.createElement("span",{className:"license-status__badge"}),r.a.createElement("span",{className:"license-status__status"},this.state.isLicensed?"Licensed":"Unlicensed"),r.a.createElement("span",{className:"license-status__limits"},this.state.isUnderLimits?"Under Limits":"Limits breached")),r.a.createElement(v.c,{color:"link",className:"license-status__refresh",onClick:function(){return e.refreshKey()}},r.a.createElement("svg",{className:"icon",viewBox:"0 0 90 80",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M74.59 57.824l10.498-5.863a3 3 0 1 1 2.926 5.238l-17.779 9.93a2.998 2.998 0 0 1-4.16-1.302l-8.934-18.299a3.002 3.002 0 0 1 1.38-4.013 3.005 3.005 0 0 1 4.013 1.38l5.795 11.87A33.02 33.02 0 0 0 72.865 40c0-18.311-14.897-33.207-33.209-33.207-18.31 0-33.206 14.896-33.206 33.207 0 18.312 14.896 33.209 33.206 33.209 1.236 0 2.476-.068 3.685-.202a3 3 0 0 1 .663 5.963 39.448 39.448 0 0 1-4.348.239C18.038 79.208.45 61.619.45 39.999.45 18.38 18.038.792 39.656.792c21.62 0 39.209 17.588 39.209 39.207a39.011 39.011 0 0 1-4.276 17.825z","fill-rule":"evenodd"}))))}},{key:"renderFingerprintStatus",value:function(){var e=this,t=this.state,n=t.serverFingerprint,s=t.licenseFingerprint;return r.a.createElement(a.Fragment,null,r.a.createElement("div",{className:"license-infos license-infos--fingerprint"},r.a.createElement("strong",{className:"license-infos__label"},"Server fingerprint:"),r.a.createElement("code",null,n),r.a.createElement(ut.CopyToClipboard,{text:n},r.a.createElement(v.c,{color:"link",size:"sm",className:"license-infos__icon"},r.a.createElement("svg",{href:"#",id:"TooltipCopy",height:"15",viewBox:"0 0 16 20",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M3.996 0H16v16h-4.004v4H0V4h3.996V0zM6 2v12h8V2H6zM2 6v12h8v-1.997H3.998V6H2z",fill:"#4A4A4A",fillRule:"evenodd"})))),r.a.createElement(v.H,{placement:"right",isOpen:this.state.tooltipCopy,target:"TooltipCopy",toggle:function(){e.setState({tooltipCopy:!e.state.tooltipCopy})}},"Copy to clipboard")),void 0!==s&&n!==s&&r.a.createElement(v.a,{color:"danger"},"Your machine fingerprint doesn't match your license fingerprint."))}},{key:"renderBody",value:function(){var e=this;return r.a.createElement(a.Fragment,null,r.a.createElement(v.F,null,r.a.createElement(v.i,{sm:"12",md:"5"},this.renderLicenseStatus(),r.a.createElement("div",{className:"license-renew"},r.a.createElement(ct,{refresh:this.props.fetchLicensing}),r.a.createElement("span",{className:"license__or"},"or"),r.a.createElement(v.c,{size:"sm",color:"link",href:"http://botpress.io/my-account/buy",target:"/blank"},"Buy license"))),r.a.createElement(v.i,{sm:"12",md:"7"},this.renderFingerprintStatus(),r.a.createElement("hr",null),r.a.createElement("div",{className:"license-infos"},r.a.createElement("strong",{className:"license-infos__label"},"Renew date:"),this.state.renewDate),r.a.createElement("div",{className:"license-infos"},r.a.createElement("strong",{className:"license-infos__label"},"Support:"),this.state.supportLevel,r.a.createElement("svg",{className:"license-infos__icon",href:"#",id:"TooltipSupport",width:"15",height:"15",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{d:"M9 16h2v-2H9v2zm1-16C4.477 0 0 4.477 0 10A10 10 0 1 0 10 0zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14a4 4 0 0 0-4 4h2a2 2 0 1 1 4 0c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5a4 4 0 0 0-4-4z",fill:"#4A4A4A",fillRule:"nonzero"})),r.a.createElement(v.H,{placement:"right",isOpen:this.state.tooltip2,target:"TooltipSupport",toggle:function(){e.setState({tooltip2:!e.state.tooltip2})}},"This is the support offered by Botpress")),r.a.createElement("hr",null),this.props.licensing&&this.props.licensing.license&&r.a.createElement("div",null,r.a.createElement("h5",null,"Policies"),r.a.createElement(lt,{license:this.props.licensing.license,breachs:this.props.licensing.breachReasons})))))}},{key:"render",value:function(){return r.a.createElement(Pe,{title:"License Status",activePage:"license",mainContent:this.state.loading?r.a.createElement(xe,null):this.renderBody()})}}]),t}(r.a.Component),pt=Object(m.b)(function(e){return{loading:e.license.loading,licensing:e.license.licensing}},function(e){return Object(b.b)({fetchLicensing:ie},e)})(mt),dt=n(50),ht=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(f.a)(this,Object(E.a)(t).call(this,e))).state={modal:!1,backdrop:!0},n.toggle=n.toggle.bind(Object(dt.a)(Object(dt.a)(n))),n.changeBackdrop=n.changeBackdrop.bind(Object(dt.a)(Object(dt.a)(n))),n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"toggle",value:function(){this.setState({modal:!this.state.modal})}},{key:"changeBackdrop",value:function(e){var t=e.target.value;"static"!==t&&(t=JSON.parse(t)),this.setState({backdrop:t})}},{key:"renderCompleteProfileModal",value:function(){return r.a.createElement(v.v,{isOpen:this.state.modal,toggle:this.toggle,className:this.props.className},r.a.createElement(v.y,{toggle:this.toggle},"Complete your profile"),r.a.createElement(v.w,null,r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"username"},r.a.createElement("strong",null,"Username")),r.a.createElement(v.p,{type:"text",id:"username"})),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"email"},r.a.createElement("strong",null,"Email")),r.a.createElement(v.p,{type:"email",id:"email"})),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"password"},r.a.createElement("strong",null,"Password")),r.a.createElement(v.p,{type:"password",id:"password"})),r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"password"},r.a.createElement("strong",null,"Confirm password")),r.a.createElement(v.p,{type:"password",id:"confirmPassword"}))),r.a.createElement(v.x,null,r.a.createElement(v.c,{color:"secondary",onClick:this.toggle},"Cancel"),r.a.createElement(v.c,{color:"primary",onClick:this.toggle,disabled:!0},"Save")," "))}},{key:"render",value:function(){return r.a.createElement("div",{className:"landing"},r.a.createElement("h2",null,"Welcome to Botpress!"),r.a.createElement("p",null,"Let's start by completing your profile"),r.a.createElement(v.c,{color:"primary",onClick:this.toggle},"Complete your profile"),this.renderCompleteProfileModal())}}]),t}(a.Component),ft=function(e){function t(){return Object(d.a)(this,t),Object(f.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"landing"},r.a.createElement("h2",null,"Hey ",this.props.userName),r.a.createElement("p",null,"Now that you've completed your profile,"," ",r.a.createElement("span",{className:"is-block"},"it's time to go in the teams section.")," We have already created a team for you!"),r.a.createElement("a",{class:"btn btn-primary",href:"/admin/teams"},"Go to the teams section"))}}]),t}(a.Component),Et=De.a.string().email().trim(),gt=function(e){function t(){var e,n;Object(d.a)(this,t);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(n=Object(f.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).state={isCreateUserModalOpen:!1,isRenderEmailModalOpen:!1,userName:"",createUserError:null},n.toggleCreateUserModalOpen=function(){n.setState({isCreateUserModalOpen:!n.state.isCreateUserModalOpen})},n.toggleRenderEmailModal=function(){n.setState({isRenderEmailModalOpen:!n.state.isRenderEmailModalOpen})},n.onInputKeyPress=function(e){return"Enter"===e.key&&n.createUser()},n.onUserNameChange=function(e){var t=De.a.validate(e.target.value,Et).error;n.setState({userName:e.target.value,canCreateUser:!t,createUserError:t})},n.onCopy=function(){n.setState({copied:!0}),window.setTimeout(function(){n.setState({copied:!1})},750)},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"createUser",value:function(){var e=Object(O.a)(w.a.mark(function e(){var t,n,a;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getSecured().post("/admin/users",{username:this.state.userName});case 2:t=e.sent,n=t.data.payload,a="Your botpress account is ready! \n\nSign-in here: ".concat(window.location.origin,"/admin/login\nUsername: ").concat(this.state.userName,"\nPassword: ").concat(n.tempPassword),this.setState({userName:"",isCreateUserModalOpen:!1,isRenderEmailModalOpen:!0,emailSubject:"Account creation successful",emailMessage:a,createUserError:null}),this.props.fetchUsers();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"resetPassword",value:function(){var e=Object(O.a)(w.a.mark(function e(t,n){var a,r,s;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to reset ".concat(t.username,"'s password?"))){e.next=7;break}return e.next=3,J.getSecured().get("/admin/users/reset/".concat(t.id));case 3:a=e.sent,r=a.data.payload,s="Your password has been reset.\n     \nUsername: ".concat(t.username,"\nPassword: ").concat(r.tempPassword),this.setState({isRenderEmailModalOpen:!0,emailSubject:"Password reset",emailMessage:s,createUserError:null});case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteUser",value:function(){var e=Object(O.a)(w.a.mark(function e(t,n){return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete ".concat(t.username,"'s account?"))){e.next=3;break}return e.next=3,J.getSecured().delete("/admin/users/".concat(t.id));case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"renderEmailModal",value:function(){return r.a.createElement(v.v,{isOpen:this.state.isRenderEmailModalOpen,toggle:this.toggleRenderEmailModal},r.a.createElement(v.y,{toggle:this.toggleRenderEmailModal},this.state.emailSubject),r.a.createElement(v.w,null,r.a.createElement(v.p,{type:"textarea",readOnly:!0,style:{height:160},value:this.state.emailMessage})),r.a.createElement(v.x,null,r.a.createElement(ut.CopyToClipboard,{text:this.state.emailMessage,onCopy:this.onCopy},r.a.createElement(v.c,null,this.state.copied?"Copied!":"Copy to clipboard"))))}},{key:"renderCreateUserModal",value:function(){var e=this;return r.a.createElement(v.v,{isOpen:this.state.isCreateUserModalOpen,toggle:this.toggleCreateUserModalOpen},r.a.createElement(v.y,{toggle:this.toggleCreateUserModalOpen},"Create a new user"),r.a.createElement(v.w,null,r.a.createElement(v.o,null,r.a.createElement(v.r,{for:"userName"},"E-mail"),r.a.createElement(v.p,{id:"userName",onChange:this.onUserNameChange,onKeyPress:this.onInputKeyPress,invalid:!!this.state.createUserError,value:this.state.userName}),!!this.state.createUserError&&r.a.createElement(v.n,null,this.state.createUserError.message))),r.a.createElement(v.x,null,r.a.createElement(v.c,{color:"primary",disabled:!this.state.canCreateUser,onClick:function(){return e.createUser()}},r.a.createElement(ge.MdGroupAdd,null)," Create")))}},{key:"renderAllUsers",value:function(){var e=this,t=[{label:"Reset Password",type:"link",onClick:function(t){return e.resetPassword(t)}},{label:"Delete",type:"link",needRefresh:!0,onClick:function(t){return e.deleteUser(t)}}];return r.a.createElement("div",null,r.a.createElement(Ye,{actions:t,detailed:"true"}))}},{key:"renderSideMenu",value:function(){return r.a.createElement("div",null,r.a.createElement(v.c,{className:"float-right",color:"primary",size:"sm",onClick:this.toggleCreateUserModalOpen},r.a.createElement(ge.MdGroupAdd,null)," Create user"),this.renderCreateUserModal(),this.renderEmailModal())}},{key:"render",value:function(){return r.a.createElement(Pe,{title:"Users",helpText:"Add or delete user",activePage:"users",mainContent:this.renderAllUsers(),sideMenu:this.renderSideMenu()})}}]),t}(a.Component),vt=Object(m.b)(function(e){return{loading:e.user.loadingUsers}},function(e){return Object(b.b)({fetchUsers:ne},e)})(gt),bt=n(196),yt=function(e){var t=e.component,n=e.auth,a=e.children,s=Object(bt.a)(e,["component","auth","children"]);return r.a.createElement(c.a,Object.assign({},s,{render:function(e){return n.isAuthenticated()?r.a.createElement(t,Object.assign({},e,{auth:n}),a):r.a.createElement(u.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},wt=n(193),Ot=Object(b.c)({routing:p.d,teams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.b:var n=t.payload.pathname;if(W.test(n)){var a=n.match(W),r=Object(k.a)(a,2)[1];return Object(C.a)({},e,{teamId:r})}return e;case"teams/FETCH_TEAMS_REQUESTED":return Object(C.a)({},e,{loadingTeams:!0});case"teams/FETCH_TEAMS_RECEIVED":return Object(C.a)({},e,{loadingTeams:!1,items:t.teams});case"teams/SWITCH_TEAM_REQUESTED":return Object(C.a)({},e,{bots:null,team:null,teams:null,roles:null,teamId:t.teamId,loadingTeam:!0});case"teams/SWITCH_TEAM_RECEIVED":return Object(C.a)({},e,{bots:t.bots,teamId:t.teamId,team:t.team,members:t.members,roles:t.roles,loadingTeam:!1});case"teams/FETCH_PERMISSIONS_REQUESTED":return Object(C.a)({},e,{permissions:null});case"teams/FETCH_PERMISSIONS_RECEIVED":return Object(C.a)({},e,{permissions:t.permissions});case"teams/FETCH_BOT_TEMPLATES_RECEIVED":return Object(C.a)({},e,{botTemplates:t.botTemplates});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"user/MY_PROFILE_REQUESTED":case"user/MY_PERMISSIONS_REQUESTED":return Object(C.a)({},e,{loading:!0});case"user/FETCH_USERS_REQUESTED":return Object(C.a)({},e,{loadingUsers:!0});case"user/MY_PROFILE_RECEIVED":return Object(C.a)({},e,{loading:!1,profile:t.profile});case"user/MY_PERMISSIONS_RECEIVED":return Object(C.a)({},e,{loading:!1,permissions:Object(C.a)({},e.permissions,Object(ee.a)({},t.teamId,t.permissions))});case"user/FETCH_USERS_RECEIVED":return Object(C.a)({},e,{loadingUsers:!1,items:t.users});default:return e}},license:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"license/FETCH_LICENSE_RECEIVED":return Object(C.a)({},e,{license:t.license});case"license/FETCH_LICENSING_RECEIVED":return Object(C.a)({},e,{licensing:t.licensing});default:return e}}}),Ct=[wt.a,Object(p.c)(D)],kt=b.d.apply(void 0,[b.a.apply(void 0,Ct)].concat([])),jt=Object(b.e)(Ot,{},kt),Mt=function(){var e=new z;return r.a.createElement(m.a,{store:jt},r.a.createElement(p.a,{history:D},r.a.createElement(l.a,null,r.a.createElement(c.a,{path:"/landing",render:function(e){return r.a.createElement(ht,null)}}),r.a.createElement(c.a,{path:"/landingstep2",render:function(e){return r.a.createElement(ft,null)}}),r.a.createElement(c.a,{path:"/login",render:function(t){return r.a.createElement(he,Object.assign({auth:e},t))}}),r.a.createElement(c.a,{path:"/changePassword",render:function(t){return r.a.createElement(it,Object.assign({auth:e},t))}}),r.a.createElement(yt,{path:"/",auth:e,component:me},r.a.createElement(l.a,null,r.a.createElement(c.a,{exact:!0,path:"/profile",render:function(e){return r.a.createElement(ot,e)}}),r.a.createElement(c.a,{exact:!0,path:"/license",render:function(e){return r.a.createElement(pt,e)}}),r.a.createElement(c.a,{exact:!0,from:"/teams/:teamId",render:function(e){var t=e.match;return r.a.createElement(u.a,{to:"/teams/".concat(t.params.teamId,"/bots")})}}),r.a.createElement(c.a,{exact:!0,path:"/teams",render:function(e){return r.a.createElement(ze,e)}}),r.a.createElement(c.a,{exact:!0,path:"/teams/:teamId/bots",render:function(e){return r.a.createElement(_e,e)}}),r.a.createElement(c.a,{exact:!0,path:"/teams/:teamId/members",render:function(e){return r.a.createElement(Ge,e)}}),r.a.createElement(c.a,{exact:!0,path:"/teams/:teamId/roles",render:function(e){return r.a.createElement(at,e)}}),r.a.createElement(c.a,{exact:!0,path:"/users",render:function(e){return r.a.createElement(vt,e)}}),r.a.createElement(u.a,{from:"/",to:"/teams"}))))))}();o.a.render(r.a.createElement("div",null,r.a.createElement(i.ToastContainer,null),Mt),document.getElementById("root"))},211:function(e,t,n){},53:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resourceMatches=function(e,t){var n=/[\/\.]/;(e=e||"").indexOf("*")<0&&(e+=".*");for(var a=e.split(n),r=t.split(n),s=!0,o=0;s&&o<a.length;o++)"*"!==a[o]&&(s=o<r.length&&a[o].toLowerCase()===r[o].toLowerCase());return s};var a={read:"r",write:"w"},r=["r","w"];t.checkRule=function(e,n,s){if(!e)return!1;if(n=n.toLowerCase(),n=a[n]||n,!r.includes(n))throw new Error("Invalid rule operation: ".concat(n));var o=!1,i=!0,l=!1,c=void 0;try{for(var u,m=e[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var p=u.value,d=p.op;if(!d||d.length<2||d.length>4)throw new Error("Invalid rule operation: ".concat(d));t.resourceMatches(p.res,s)&&(4===d.length?o=d[1]===n?"+"===d[0]:d[3]===n&&"+"===d[2]:3===d.length?o="+"===d[0]:2===d.length&&d[1]===n&&(o="+"===d[0]))}}catch(h){l=!0,c=h}finally{try{i||null==m.return||m.return()}finally{if(l)throw c}}return o},t.checkMultipleRoles=function(e,n,a){if(!e)return!1;for(var r in e)if(t.checkRule(e[r],n,a))return!0;return!1}},79:function(e,t,n){e.exports=n.p+"static/media/nobg_white.5a44bde7.png"}},[[198,2,1]]]);